---
title: "Study Sites"
author: "Vanessa Neo"
date: "`r lubridate::today()`"
output: pdf_document
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r Map, echo = FALSE, warning = FALSE, message = FALSE}
library(tidyverse)
library(maps)
library(ggrepel)
library(ggmap)
library(grid)

watercolor <- get_map(location = c(lon = 125, lat = -20), zoom = 3, source = 'stamen', maptype="watercolor")

Study_Sites <- read_csv(here::here("data_raw", "Combined_Site_Coordinates_Full.csv")) 

SS_Map <- ggmap(watercolor, fullpage = TRUE) +
  geom_point(data = Study_Sites, aes(x = Longitude, y = Latitude, shape = Reef), size = 3, position = "dodge") +
  labs(title = "Study Sites", caption = "Number of Sites = 19") +
  theme(plot.caption = element_text(hjust = 0.5, size = 9), legend.title = element_blank(), legend.key = element_rect(fill = "transparent"), panel.background = element_rect(fill = "transparent"), legend.position = "bottom", legend.text = element_text(size = 7), plot.title = element_text(size = 12)) +
  #xlim(85, 175) + #for full map
  #ylim(-50, 10) + #for full map
  xlim(95, 150) +
  ylim(-35, 0) +
  guides(shape = guide_legend(nrow = 2))
 
SS_Map

ggsave("study sites.png", path = here::here("graphics/Figures"), dpi = 300, width = 210, height = 100, units = "mm", limitsize = TRUE, bg = "transparent")

Cocos_getmap <- get_map(location = c(lon = 97, lat = -12), zoom = 10, source = 'stamen', maptype="watercolor")

Cocos <- ggmap(Cocos_getmap, fullpage = TRUE) +
  geom_point(data = Study_Sites, aes(x = Longitude, y = Latitude, shape = Reef), size = 3, position = "dodge") +
  theme(plot.caption = element_text(hjust = 0.5, size = 9), legend.title = element_blank(), legend.key = element_rect(fill = "transparent"), panel.background = element_rect(fill = "transparent"), legend.position = "none", legend.text = element_blank(), plot.title = element_text(size = 9)) +
  labs(title = "Cocos Keeling Island") +
  geom_label_repel(data = Study_Sites, aes(x = Longitude, y = Latitude, label = Site))

Cocos

ggsave("Cocos.png", path = here::here("graphics/Figures"), dpi = 300, width = 210, height = 100, units = "mm", limitsize = TRUE, bg = "transparent")

Browse_getmap <- get_map(location = c(lon = 124, lat = -14), zoom = 8, source = 'stamen', maptype="watercolor")

Browse <- ggmap(Browse_getmap, fullpage = TRUE) +
  geom_point(data = Study_Sites, aes(x = Longitude, y = Latitude, shape = Reef), size = 3, position = "dodge") +
  theme(plot.caption = element_text(hjust = 0.5, size = 9), legend.title = element_blank(), legend.key = element_rect(fill = "transparent"), panel.background = element_rect(fill = "transparent"), legend.position = "none", legend.text = element_blank(), plot.title = element_text(size = 9)) +
  labs(title = "Browse Island") +
  geom_label_repel(data = Study_Sites, aes(x = Longitude, y = Latitude, label = Site))

Browse

ggsave("Browse.png", path = here::here("graphics/Figures"), dpi = 300, width = 210, height = 100, units = "mm", limitsize = TRUE, bg = "transparent")

Scott_getmap <- get_map(location = c(lon = 122, lat = -13.9), zoom = 10, source = 'stamen', maptype="watercolor")

Scott <- ggmap(Scott_getmap, fullpage = TRUE) +
  geom_point(data = Study_Sites, aes(x = Longitude, y = Latitude, shape = Reef), size = 3, position = "dodge") +
  theme(plot.caption = element_text(hjust = 0.5, size = 9), legend.title = element_blank(), legend.key = element_rect(fill = "transparent"), panel.background = element_rect(fill = "transparent"), legend.position = "none", legend.text = element_blank(), plot.title = element_text(size = 9)) +
  labs(title = "Scott Reef") +
  geom_label_repel(data = Study_Sites, aes(x = Longitude, y = Latitude, label = Site))

Scott

ggsave("Scott.png", path = here::here("graphics/Figures"), dpi = 300, width = 210, height = 100, units = "mm", limitsize = TRUE, bg = "transparent")

Ningaloo_getmap <- get_map(location = c(lon = 114, lat = -21.9), zoom = 9, source = 'stamen', maptype="watercolor")

Ningaloo <- ggmap(Ningaloo_getmap, fullpage = TRUE) +
  geom_point(data = Study_Sites, aes(x = Longitude, y = Latitude, shape = Reef), size = 3, position = "dodge") +
  theme(plot.caption = element_text(hjust = 0.5, size = 9), legend.title = element_blank(), legend.key = element_rect(fill = "transparent"), panel.background = element_rect(fill = "transparent"), legend.position = "none", legend.text = element_blank(), plot.title = element_text(size = 9)) +
  labs(title = "Ningaloo Reef") +
  geom_label_repel(data = Study_Sites, aes(x = Longitude, y = Latitude, label = Site))

Ningaloo

ggsave("Ningaloo.png", path = here::here("graphics/Figures"), dpi = 300, width = 210, height = 100, units = "mm", limitsize = TRUE, bg = "transparent")

HAbrol_getmap <- get_map(location = c(lon = 113.7, lat = -28.5), zoom = 9, source = 'stamen', maptype="watercolor")

HAbrol <- ggmap(HAbrol_getmap, fullpage = TRUE) +
  geom_point(data = Study_Sites, aes(x = Longitude, y = Latitude, shape = Reef), size = 3, position = "dodge") +
  theme(plot.caption = element_text(hjust = 0.5, size = 9), legend.title = element_blank(), legend.key = element_rect(fill = "transparent"), panel.background = element_rect(fill = "transparent"), legend.position = "none", legend.text = element_blank(), plot.title = element_text(size = 9)) +
  labs(title = "Houtman Abrolhos Island") +
  geom_label_repel(data = Study_Sites, aes(x = Longitude, y = Latitude, label = Site))

HAbrol

ggsave("HAbrol.png", path = here::here("graphics/Figures"), dpi = 300, width = 210, height = 100, units = "mm", limitsize = TRUE, bg = "transparent")

#Creating publication map with main map + insets
mainmap <- viewport(width = 1, height = 0.7, x = 0.5, y = 0.3)
insetmap_Cocos <- viewport (width = 0.75, height = 0.3, x = 0.5, y = 0.85)
insetmap_Ningaloo <- viewport(width = 0.7, height = 0.55, x = 0.15, y = 0.72)
insetmap_HAbrol <- viewport(width = 0.7, height = 0.5, x = 0.15, y = 0.15)
insetmap_Scott <- viewport(width = 0.7, height = 0.55, x = 0.85, y = 0.72)
insetmap_Browse <- viewport(width = 0.7, height = 0.5, x = 0.85, y = 0.15)
grid.newpage()
print(SS_Map, vp = mainmap)
print(Cocos, vp = insetmap_Cocos)
print(Ningaloo, vp = insetmap_Ningaloo)
print(HAbrol, vp = insetmap_HAbrol)
print(Scott, vp = insetmap_Scott)
print(Browse, vp = insetmap_Browse)

ggsave("Study Sites with Insets.jpg", dpi = 300)


###Old Code###
#Aus <- map_data("world") %>% 
 # filter(region == "Australia")

#cols <- c("Browse Island" = "#CC6666", "Scott Reef" = "#9999CC", "Cocos (Keeling) Islands" = "#66CC99", "Ningaloo Reef" = "#FFCC99", "Houtman Abrolhos" = "dark blue")

# geom_polygon(data = Aus, aes(x = long, y = lat, group = group), fill = "grey") +
 # geom_point(data = Study_Sites, aes(x = Longitude, y = Latitude, color = Reef), size = 3 ) +
  #geom_label_repel(data = Study_Sites, aes(x = Longitude, y = Latitude, label = Site, fill = Reef), size = 4, max.overlaps = 40, segment.color = "grey80") +
  #scale_color_manual(values = cols) +
  #xlab("Longitude") +
  #ylab("Latitude") +
  #ylim(-40, -10) +
  #xlim(95, 125) +
  #labs(caption = "Number of Sites = 19")+
  #coord_fixed(ratio = 1) +
  #theme(legend.key = element_rect(fill = "transparent"), panel.grid = element_line(color = "transparent"), legend.position = "bottom", axis.title = element_text(size = 12), panel.background = element_rect(fill = "transparent"), axis.line = element_line(color = "black"), plot.caption = element_text(hjust = 0.5, size = 12), legend.title = element_blank() )

#ggsave("study sites.png", path = here::here("graphics/Figures"), dpi = 300, width = 210, height = 100, units = "mm", limitsize = FALSE)

```
