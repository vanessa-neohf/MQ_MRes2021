---
title: "Raw SrCa TS"
author: "Vanessa Neo"
date: "`r Sys.Date()`"
output: html_document
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r load_packages_and_file, include = FALSE}
library(tidyverse)
library(lubridate)

Browse <- read_csv(here::here("data_raw/CCore_BRS05_BRS07_Year_Month.csv")) %>% 
  select(c(2,3,9,10)) %>% 
  mutate(date = ym(str_c(year, month)))

Browse05_SST_CCI <- read_csv(here::here("data_raw/CCore_SST_BRS05_CCI.csv"))

Browse05_SST_NOAA <- read_csv(here::here("data_raw/CCore_SST_BRS05_NOAA.csv"))

Browse07_SST_CCI <- read_csv(here::here("data_raw/CCore_SST_BRS07_CCI.csv"))

Browse07_SST_NOAA <- read_csv(here::here("data_raw/CCore_SST_BRS07_NOAA.csv"))
```

```{r plot_TS}
Browse05 <- Browse %>% 
  drop_na(`BRS05 Sr/Ca [mmol/mol]`) %>% 
  select(-c(`BRS07 Sr/Ca [mmol/mol]`, year, month))

Browse07 <- Browse %>% 
  drop_na(`BRS07 Sr/Ca [mmol/mol]`) %>% 
  select(-c(`BRS05 Sr/Ca [mmol/mol]`, year, month))

Coeff <- 3

ggplot(Browse05) +
  geom_point(aes(x = date, y = `BRS05 Sr/Ca [mmol/mol]`)) +
  geom_line(data = Browse05_SST_CCI, aes(x = date, y = sst/Coeff)) +
  scale_y_continuous(name = "BRS05 Sr/Ca [mmol/mol]", sec.axis = sec_axis(~ .*Coeff, name = "SST calibrated by CCI")) +
  labs(title = "Browse Island BRS05 raw Sr/Ca time series and SST calibrated by CCI", x = "Time", caption = "dots represent Sr/Ca values and lines represent SST values") +
  theme(panel.grid.major.y = element_line(color = "grey", linetype = "dashed"),
        legend.key = element_rect(fill = "transparent"),
        plot.title = element_text( face = "bold", size = 12),
        legend.position = "right",
        panel.background = element_blank(),
        axis.line = element_line(color = "grey"),
        axis.title = element_text(size = 12),
        plot.caption = element_text(hjust = 0.5)
  )

ggsave("SrCa raw time series Browse BRS05 and CCI calibrated SST.jpg", path = here::here("graphics/Supplementary"), dpi = 300, scale = 2)

ggplot(Browse05) +
  geom_point(aes(x = date, y = `BRS05 Sr/Ca [mmol/mol]`)) +
  geom_line(data = Browse05_SST_NOAA, aes(x = date, y = sst/Coeff)) +
  scale_y_continuous(name = "BRS05 Sr/Ca [mmol/mol]", sec.axis = sec_axis(~ .*Coeff, name = "SST calibrated by NOAA")) +
  labs(title = "Browse Island BRS05 raw Sr/Ca time series and SST calibrated by NOAA", x = "Time", caption = "dots represent Sr/Ca values and lines represent SST values") +
  theme(panel.grid.major.y = element_line(color = "grey", linetype = "dashed"),
        legend.key = element_rect(fill = "transparent"),
        plot.title = element_text( face = "bold", size = 12),
        legend.position = "right",
        panel.background = element_blank(),
        axis.line = element_line(color = "grey"),
        axis.title = element_text(size = 12),
        plot.caption = element_text(hjust = 0.5)
  )

ggsave("SrCa raw time series Browse BRS05 and NOAA calibrated SST.jpg", path = here::here("graphics/Supplementary"), dpi = 300, scale = 2)

ggplot(Browse07) +
  geom_point(aes(x = date, y = `BRS07 Sr/Ca [mmol/mol]`)) +
  geom_line(data = Browse07_SST_CCI, aes(x = date, y = sst/Coeff)) +
  scale_y_continuous(name = "BRS07 Sr/Ca [mmol/mol]", sec.axis = sec_axis(~ .*Coeff, name = "SST calibrated by CCI")) +
  labs(title = "Browse Island BRS07 raw Sr/Ca time series and SST calibrated by CCI", x = "Time", caption = "dots represent Sr/Ca values and lines represent SST values") +
  theme(panel.grid.major.y = element_line(color = "grey", linetype = "dashed"),
        legend.key = element_rect(fill = "transparent"),
        plot.title = element_text( face = "bold", size = 12),
        legend.position = "right",
        panel.background = element_blank(),
        axis.line = element_line(color = "grey"),
        axis.title = element_text(size = 12),
        plot.caption = element_text(hjust = 0.5)
  )

ggsave("SrCa raw time series Browse BRS07 and CCI calibrated SST.jpg", path = here::here("graphics/Supplementary"), dpi = 300, scale = 2)

ggplot(Browse07) +
  geom_point(aes(x = date, y = `BRS07 Sr/Ca [mmol/mol]`)) +
  geom_line(data = Browse07_SST_NOAA, aes(x = date, y = sst/Coeff)) +
  scale_y_continuous(name = "BRS07 Sr/Ca [mmol/mol]", sec.axis = sec_axis(~ .*Coeff, name = "SST calibrated by NOAA")) +
  labs(title = "Browse Island BRS07 raw Sr/Ca time series and SST calibrated by NOAA", x = "Time", caption = "dots represent Sr/Ca values and lines represent SST values") +
  theme(panel.grid.major.y = element_line(color = "grey", linetype = "dashed"),
        legend.key = element_rect(fill = "transparent"),
        plot.title = element_text( face = "bold", size = 12),
        legend.position = "right",
        panel.background = element_blank(),
        axis.line = element_line(color = "grey"),
        axis.title = element_text(size = 12),
        plot.caption = element_text(hjust = 0.5)
  )

ggsave("SrCa raw time series Browse BRS07 and NOAA calibrated SST.jpg", path = here::here("graphics/Supplementary"), dpi = 300, scale = 2)

```

